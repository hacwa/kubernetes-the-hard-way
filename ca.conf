[req]
distinguished_name = req_distinguished_name
prompt             = no
x509_extensions    = ca_x509_extensions

[ca_x509_extensions]
basicConstraints = CA:TRUE
keyUsage         = cRLSign, keyCertSign

[req_distinguished_name]
C   = UK
ST  = MANCHESTER
L   = SEATTLE
CN  = CA

[admin]
distinguished_name = ADMIN_distinguished_name
prompt             = no
req_extensions     = default_req_extensions

[ADMIN_distinguished_name]
CN = ADMIN
O  = SYSTEM:MASTERS

[service-accounts]
distinguished_name = SERVICE-ACCOUNTS_distinguished_name
prompt             = no
req_extensions     = default_req_extensions

[SERVICE-ACCOUNTS_distinguished_name]
CN = SERVICE-ACCOUNTS

[K8S-WORKER-01-VM]
distinguished_name = K8S-WORKER-01-VM_distinguished_name
prompt             = no
req_extensions     = K8S-WORKER-01-VM_req_extensions

[K8S-WORKER-01-VM_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "K8S-WORKER-01-VM Certificate"
subjectAltName       = DNS:K8S-WORKER-01-VM, IP:10.0.22.2
subjectKeyIdentifier = hash

[K8S-WORKER-01-VM_distinguished_name]
CN = SYSTEM:NODE:K8S-WORKER-01-VM
O  = SYSTEM:NODES
C  = UK
ST = MANCHESTER
L  = SEATTLE

[K8S-WORKER-02-VM]
distinguished_name = K8S-WORKER-02-VM_distinguished_name
prompt             = no
req_extensions     = K8S-WORKER-02-VM_req_extensions

[K8S-WORKER-02-VM_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "K8S-WORKER-02-VM Certificate"
subjectAltName       = DNS:K8S-WORKER-02-VM, IP:10.0.22.3
subjectKeyIdentifier = hash

[K8S-WORKER-02-VM_distinguished_name]
CN = SYSTEM:NODE:K8S-WORKER-02-VM
O  = SYSTEM:NODES
C  = UK
ST = MANCHESTER
L  = SEATTLE

[K8S-WORKER-03-VM]
distinguished_name = K8S-WORKER-03-VM_distinguished_name
prompt             = no
req_extensions     = K8S-WORKER-03-VM_req_extensions

[K8S-WORKER-03-VM_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "K8S-WORKER-03-VM Certificate"
subjectAltName       = DNS:K8S-WORKER-03-VM, IP:10.0.22.4
subjectKeyIdentifier = hash

[K8S-WORKER-03-VM_distinguished_name]
CN = SYSTEM:NODE:K8S-WORKER-03-VM
O  = SYSTEM:NODES
C  = UK
ST = MANCHESTER
L  = SEATTLE

[kube-proxy]
distinguished_name = KUBE-PROXY_distinguished_name
prompt             = no
req_extensions     = KUBE-PROXY_req_extensions

[KUBE-PROXY_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Kube Proxy Certificate"
subjectAltName       = DNS:KUBE-PROXY
subjectKeyIdentifier = hash

[KUBE-PROXY_distinguished_name]
CN = SYSTEM:KUBE-PROXY
O  = SYSTEM:NODE-PROXIER
C  = UK
ST = MANCHESTER
L  = SEATTLE

[kube-controller-manager]
distinguished_name = KUBE-CONTROLLER-MANAGER_distinguished_name
prompt             = no
req_extensions     = KUBE-CONTROLLER-MANAGER_req_extensions

[KUBE-CONTROLLER-MANAGER_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Kube Controller Manager Certificate"
subjectAltName       = DNS:KUBE-CONTROLLER-MANAGER
subjectKeyIdentifier = hash

[KUBE-CONTROLLER-MANAGER_distinguished_name]
CN = SYSTEM:KUBE-CONTROLLER-MANAGER
O  = SYSTEM:KUBE-CONTROLLER-MANAGER
C  = UK
ST = MANCHESTER
L  = SEATTLE

[kube-scheduler]
distinguished_name = KUBE-SCHEDULER_distinguished_name
prompt             = no
req_extensions     = KUBE-SCHEDULER_req_extensions

[KUBE-SCHEDULER_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Kube Scheduler Certificate"
subjectAltName       = DNS:KUBE-SCHEDULER
subjectKeyIdentifier = hash

[KUBE-SCHEDULER_distinguished_name]
CN = SYSTEM:KUBE-SCHEDULER
O  = SYSTEM:KUBE-SCHEDULER
C  = UK
ST = MANCHESTER
L  = SEATTLE

[kube-api-server]
distinguished_name = KUBE-API-SERVER_distinguished_name
prompt             = no
req_extensions     = KUBE-API-SERVER_req_extensions

[KUBE-API-SERVER_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth, serverAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Kube API Server Certificate"
subjectAltName       = @KUBE-API-SERVER_alt_names
subjectKeyIdentifier = hash

[KUBE-API-SERVER_alt_names]
IP.0  = 127.0.0.1
IP.1  = 10.32.0.1
IP.2  = 10.0.21.2
IP.3  = 10.0.21.3
IP.4  = 10.0.21.4
IP.5  = 10.0.20.2
IP.6  = 10.0.20.3
IP.7  = 10.0.20.4
DNS.0 = KUBERNETES
DNS.1 = KUBERNETES.DEFAULT
DNS.2 = KUBERNETES.HACWA
DNS.3 = KUBERNETES.DEFAULT.SVC
DNS.4 = KUBERNETES.HACWA.SVC
DNS.5 = SERVER.KUBERNETES.LOCAL
DNS.6 = SERVER.HACWA.INTERNAL
DNS.7 = API-SERVER.KUBERNETES.LOCAL
DNS.8 = API-SERVER.HACWA.INTERNAL
DNS.9 = K8S-CONTROL-PLANE-01-VM
DNS.10 = K8S-CONTROL-PLANE-02-VM
DNS.11 = K8S-CONTROL-PLANE-03-VM
DNS.12 = K8S-LB-01-VM
DNS.13 = K8S-LB-02-VM
DNS.14 = K8S-LB-VIP-VM

[KUBE-API-SERVER_distinguished_name]
CN = KUBERNETES
C  = UK
ST = MANCHESTER
L  = SEATTLE

[default_req_extensions]
basicConstraints     = CA:FALSE
extendedKeyUsage     = clientAuth
keyUsage             = critical, digitalSignature, keyEncipherment
nsCertType           = client
nsComment            = "Admin Client Certificate"
subjectKeyIdentifier = hash
